---
import DocLayout from '../layouts/DocLayout.astro';
---

<DocLayout
  title="âš¡ MST SDK - é–‹æºç¶²é€Ÿæ¸¬è©¦ SDKï¼Œå…è²»æ•´åˆ"
  description="MST SDK é–‹æºç¶²é€Ÿæ¸¬è©¦å·¥å…·ã€‚å‰ç«¯åŸ·è¡Œã€å®Œå…¨é€æ˜ã€æ˜“æ–¼æ•´åˆã€‚npm install å³å¯ä½¿ç”¨ï¼Œé™„å®Œæ•´ç¯„ä¾‹ç¨‹å¼ç¢¼ã€‚"
  canonical="https://myspeedtest.isnowfriend.com/sdk"
  activeNav="sdk"
>
  <section class="hero">
    <h1>MST <span class="highlight-blue">SDK</span></h1>
    <p>é–‹æºã€é€æ˜ã€æ˜“æ–¼æ•´åˆçš„ç¶²é€Ÿæ¸¬è©¦ SDK<br>ç”¨ç¨‹å¼ç¢¼ç†è§£æ¸¬é€ŸåŸç†</p>
    <div class="hero-btns">
      <a href="/sdk/mst.js" class="btn btn-primary" download>ä¸‹è¼‰ SDK</a>
    </div>
  </section>

  <section class="features">
    <div class="feature">
      <div class="feature-icon red">ğŸŒ</div>
      <h3>å‰ç«¯åŸ·è¡Œ</h3>
      <p>æ¸¬é€Ÿåœ¨ç”¨æˆ¶ç€è¦½å™¨åŸ·è¡Œï¼Œæ¸¬åˆ°çš„æ˜¯çœŸå¯¦çš„ç”¨æˆ¶ç¶²é€Ÿã€‚</p>
    </div>
    <div class="feature">
      <div class="feature-icon yellow">ğŸ“–</div>
      <h3>å®Œå…¨é–‹æº</h3>
      <p>ç¨‹å¼ç¢¼å®Œå…¨å…¬é–‹ï¼Œæ¯ä¸€è¡Œæ¸¬é€Ÿé‚è¼¯éƒ½å¯ä»¥é©—è­‰ã€‚</p>
    </div>
    <div class="feature">
      <div class="feature-icon blue">âš¡</div>
      <h3>è¼•é‡å¿«é€Ÿ</h3>
      <p>SDK åªæœ‰ 5KBï¼Œé›¶ä¾è³´ï¼Œæ”¯æ´ ES Moduleã€‚</p>
    </div>
    <div class="feature">
      <div class="feature-icon red">ğŸ¯</div>
      <h3>äº‹ä»¶é©…å‹•</h3>
      <p>å³æ™‚é€²åº¦å›å ±ï¼Œè¼•é¬†æ•´åˆåˆ°ä»»ä½• UI æ¡†æ¶ã€‚</p>
    </div>
  </section>

  <main class="content">
    <section class="section">
      <h2>å¿«é€Ÿé–‹å§‹</h2>
      <h3>1. å¼•å…¥ SDK</h3>
      <div class="code-block">
        <div class="code-header">HTML</div>
        <div class="code-content">
          <code>&lt;<span class="keyword">script</span> <span class="function">src</span>=<span class="string">"/sdk/mst.js"</span>&gt;&lt;/<span class="keyword">script</span>&gt;</code>
        </div>
      </div>
      <h3>2. åŸ·è¡Œæ¸¬é€Ÿ</h3>
      <div class="code-block">
        <div class="code-header">JavaScript</div>
        <div class="code-content">
          <code><span class="comment">// å»ºç«‹å¯¦ä¾‹</span>
<span class="keyword">const</span> mst = <span class="keyword">new</span> <span class="function">MST</span>();

<span class="comment">// ç›£è½é€²åº¦</span>
mst.<span class="function">on</span>(<span class="string">'progress'</span>, (&#123; speed &#125;) =&gt; &#123;
  console.<span class="function">log</span>(speed.value, speed.unit);
&#125;);

<span class="comment">// æ¸¬é€Ÿå®Œæˆ</span>
mst.<span class="function">on</span>(<span class="string">'complete'</span>, (result) =&gt; &#123;
  console.<span class="function">log</span>(<span class="string">'å®Œæˆ:'</span>, result.speed);
&#125;);

<span class="comment">// åŸ·è¡Œ</span>
<span class="keyword">await</span> mst.<span class="function">run</span>();</code>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>Live Demo</h2>
      <div class="demo-panel">
        <div class="demo-speed" id="demoSpeed">0</div>
        <div class="demo-unit" id="demoUnit">Mbps</div>
        <button class="demo-btn" id="demoBtn">æ¸¬è©¦ SDK</button>
        <div class="demo-status" id="demoStatus"></div>
      </div>
      <div class="code-block">
        <div class="code-header">Console Output</div>
        <div class="code-content" style="max-height: 200px; overflow-y: auto;">
          <code id="demoLog"><span class="comment">// é»æ“Šä¸Šæ–¹æŒ‰éˆ•æŸ¥çœ‹è¼¸å‡º...</span></code>
        </div>
      </div>
    </section>

    <section class="section">
      <h2>API Reference</h2>
      <h3>Constructor</h3>
      <div class="code-block">
        <div class="code-content">
          <code><span class="keyword">new</span> <span class="function">MST</span>(options)</code>
        </div>
      </div>
      <table>
        <tr><th>é¸é …</th><th>é¡å‹</th><th>é è¨­å€¼</th><th>èªªæ˜</th></tr>
        <tr><td><code>apiEndpoint</code></td><td>string</td><td>/api/mst</td><td>å¾Œç«¯ API ç«¯é»</td></tr>
        <tr><td><code>duration</code></td><td>number</td><td>10000</td><td>æ¸¬é€Ÿæ™‚é–“ï¼ˆæ¯«ç§’ï¼‰</td></tr>
        <tr><td><code>maxConnections</code></td><td>number</td><td>3</td><td>æœ€å¤§ä¸¦è¡Œé€£ç·šæ•¸</td></tr>
        <tr><td><code>chunkSize</code></td><td>number</td><td>524288</td><td>ä¸‹è¼‰å€å¡Šå¤§å°ï¼ˆbytesï¼‰</td></tr>
      </table>
      <h3>Methods</h3>
      <table>
        <tr><th>æ–¹æ³•</th><th>èªªæ˜</th></tr>
        <tr><td><code>run()</code></td><td>åŸ·è¡Œæ¸¬é€Ÿï¼Œè¿”å› Promise</td></tr>
        <tr><td><code>stop()</code></td><td>åœæ­¢æ¸¬é€Ÿ</td></tr>
        <tr><td><code>on(event, callback)</code></td><td>è¨»å†Šäº‹ä»¶ç›£è½å™¨</td></tr>
        <tr><td><code>off(event, callback)</code></td><td>ç§»é™¤äº‹ä»¶ç›£è¯å™¨</td></tr>
      </table>
      <h3>Events</h3>
      <table>
        <tr><th>äº‹ä»¶</th><th>è§¸ç™¼æ™‚æ©Ÿ</th><th>è³‡æ–™</th></tr>
        <tr><td><code>start</code></td><td>æ¸¬é€Ÿé–‹å§‹</td><td>&#123; timestamp &#125;</td></tr>
        <tr><td><code>targets</code></td><td>å–å¾—ç¯€é»</td><td>&#123; targets, count &#125;</td></tr>
        <tr><td><code>progress</code></td><td>é€²åº¦æ›´æ–°</td><td>&#123; progress, elapsed, bytes, speed &#125;</td></tr>
        <tr><td><code>complete</code></td><td>æ¸¬é€Ÿå®Œæˆ</td><td>&#123; speed, bytes, duration, targets &#125;</td></tr>
        <tr><td><code>error</code></td><td>ç™¼ç”ŸéŒ¯èª¤</td><td>&#123; error, message &#125;</td></tr>
      </table>
    </section>

    <section class="section">
      <h2>ç‚ºä»€éº¼æ¸¬é€Ÿè¦åœ¨å‰ç«¯åŸ·è¡Œï¼Ÿ</h2>
      <p>é€™æ˜¯ä¸€å€‹å¾ˆå¤šäººæœƒå•çš„å•é¡Œï¼šã€Œç‚ºä»€éº¼ä¸åœ¨å¾Œç«¯æ¸¬é€Ÿå°±å¥½ï¼Ÿã€</p>
      <p><strong>ç­”æ¡ˆå¾ˆç°¡å–®ï¼šæ¸¬é€Ÿä¸€å®šè¦è·‘åœ¨é »å¯¬ç“¶é ¸é‚£ä¸€ç«¯ã€‚</strong></p>
      <div class="code-block">
        <div class="code-content">
          <code><span class="comment">// å¦‚æœåœ¨å¾Œç«¯æ¸¬é€Ÿ...</span>
[å¾Œç«¯ä¼ºæœå™¨] â†â†’ [CDN]
     â†‘
  æ¸¬åˆ°çš„æ˜¯ã€Œä¼ºæœå™¨çš„ç¶²é€Ÿã€ï¼Œä¸æ˜¯ç”¨æˆ¶çš„

<span class="comment">// æ­£ç¢ºåšæ³•ï¼šåœ¨å‰ç«¯æ¸¬é€Ÿ</span>
[ç”¨æˆ¶ç€è¦½å™¨] â†â†’ [CDN]
     â†‘
  æ¸¬åˆ°çš„æ˜¯ã€Œç”¨æˆ¶çš„ç¶²é€Ÿã€</code>
        </div>
      </div>
      <div class="info-box blue">
        <p>MST SDK çš„è¨­è¨ˆå°±æ˜¯åŸºæ–¼é€™å€‹åŸç†ï¼šå¾Œç«¯åªè² è²¬æä¾› CDN ç¯€é»è³‡è¨Šï¼ŒçœŸæ­£çš„ä¸‹è¼‰æµé‡éƒ½åœ¨ç”¨æˆ¶çš„ç€è¦½å™¨åŸ·è¡Œã€‚</p>
      </div>
      <p style="margin-top: 25px;"><a href="/api" style="color: var(--blue);">â†’ æŸ¥çœ‹å¾Œç«¯ API æ–‡ä»¶</a></p>
    </section>
  </main>
</DocLayout>

<style>
  .highlight-blue {
    color: var(--blue);
  }

  .hero-btns {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 30px;
  }

  .btn {
    padding: 14px 32px;
    border-radius: 100px;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s;
  }

  .btn-primary {
    background: var(--white);
    color: var(--bg);
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
  }

  .btn-secondary {
    background: transparent;
    color: var(--white);
    border: 2px solid var(--gray-dark);
  }

  .btn-secondary:hover {
    border-color: var(--yellow);
    color: var(--yellow);
  }

  .features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    max-width: 1000px;
    margin: 0 auto;
    padding: 40px 20px 60px;
  }

  .feature {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 30px;
    transition: transform 0.3s;
    box-shadow: 0 2px 20px rgba(0,0,0,0.08);
  }

  .feature:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  }

  .feature-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-bottom: 20px;
  }

  .feature-icon.red { background: rgba(255, 71, 87, 0.2); }
  .feature-icon.yellow { background: rgba(255, 165, 2, 0.2); }
  .feature-icon.blue { background: rgba(55, 66, 250, 0.2); }

  .feature h3 {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--white);
  }

  .feature p {
    font-size: 14px;
    color: var(--gray);
    line-height: 1.6;
  }

  .demo-panel {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 40px;
    text-align: center;
    margin: 30px 0;
    box-shadow: 0 2px 20px rgba(0,0,0,0.08);
  }

  .demo-speed {
    font-size: 72px;
    font-weight: 300;
    color: #ff9500;
    font-variant-numeric: tabular-nums;
  }

  .demo-unit {
    font-size: 18px;
    color: var(--gray);
    letter-spacing: 4px;
    margin-bottom: 25px;
  }

  .demo-btn {
    padding: 14px 40px;
    background: #1a1a1a;
    color: #ffffff;
    border: none;
    border-radius: 100px;
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }

  .demo-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  }

  .demo-btn.running {
    background: #ff9500;
  }

  .demo-status {
    margin-top: 20px;
    font-size: 14px;
    color: var(--gray);
    min-height: 20px;
  }

  @media (max-width: 768px) {
    .demo-speed {
      font-size: 56px;
    }
  }
</style>

<script is:inline src="/sdk/mst.js"></script>
<script is:inline>
  var demoMst = null;

  async function runDemo() {
    var btn = document.getElementById('demoBtn');
    var speedEl = document.getElementById('demoSpeed');
    var unitEl = document.getElementById('demoUnit');
    var statusEl = document.getElementById('demoStatus');
    var logEl = document.getElementById('demoLog');

    if (!btn || !speedEl || !unitEl || !statusEl || !logEl) return;

    if (demoMst && demoMst.isRunning) {
      demoMst.stop();
      return;
    }

    demoMst = new MST({ duration: 5000 });

    btn.textContent = 'STOP';
    btn.classList.add('running');
    speedEl.textContent = '0';
    logEl.innerHTML = '';

    function log(text) {
      var time = new Date().toLocaleTimeString();
      logEl.innerHTML += '<span class="comment">[' + time + ']</span> ' + text + '\n';
      if (logEl.parentElement) {
        logEl.parentElement.scrollTop = logEl.parentElement.scrollHeight;
      }
    }

    demoMst
      .on('start', function() {
        log('<span class="keyword">Event:</span> start');
        statusEl.textContent = 'é€£æ¥ä¸­...';
      })
      .on('targets', function(data) {
        log('<span class="keyword">Event:</span> targets (' + data.count + ' nodes)');
        statusEl.textContent = 'æ¸¬é€Ÿä¸­...';
      })
      .on('progress', function(data) {
        speedEl.textContent = data.speed.value;
        unitEl.textContent = data.speed.unit;
      })
      .on('complete', function(result) {
        log('<span class="keyword">Event:</span> complete');
        log('<span class="function">Result:</span> ' + result.speed.value + ' ' + result.speed.unit);
        log('<span class="function">Downloaded:</span> ' + (result.bytes / 1024 / 1024).toFixed(2) + ' MB');
        log('<span class="function">Duration:</span> ' + result.duration.toFixed(2) + 's');
        statusEl.textContent = (result.bytes / 1024 / 1024).toFixed(1) + ' MB';
        btn.textContent = 'å†æ¸¬ä¸€æ¬¡';
        btn.classList.remove('running');
      })
      .on('error', function(data) {
        log('<span class="number">Error:</span> ' + data.message);
        statusEl.textContent = data.message;
        btn.textContent = 'é‡è©¦';
        btn.classList.remove('running');
      });

    try {
      await demoMst.run();
    } catch (e) {}
  }

  document.getElementById('demoBtn').addEventListener('click', runDemo);
</script>
